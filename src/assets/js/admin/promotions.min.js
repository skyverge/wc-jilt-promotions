jQuery(function(s){s.JiltPromotions={},s.JiltPromotions.InstallPluginModal=class{constructor(s){this.options={messageID:s.messageID||"",target:s.target||"",onClose:s.onClose||""},""!==this.options.messageID?(""===this.options.target&&(this.options.target="tmpl-sv-wc-jilt-promotions-"+this.options.messageID+"-modal"),this.initialize(),this.open()):console.log("InstallPluginModal: missing messageID")}initialize(){s("#sv-wc-jilt-install-button-install").on("click",function(t){s.JiltPromotions.InstallPluginModal.onInstall(t)}),s("#sv-wc-jilt-install-modal .modal-close").on("click",function(t){s.JiltPromotions.InstallPluginModal.onClose(t)})}open(){s("#wc-backbone-modal-dialog .modal-close").trigger("click"),new s.WCBackboneModal.View({target:this.options.target})}static onInstall(t){t.preventDefault(),s("#sv-wc-jilt-install-modal .wc-backbone-modal-content").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),s.post(ajaxurl,{action:"sv_wc_jilt_install_jilt",nonce:sv_wc_jilt_prompt_install.nonces.install_plugin,prompt_id:this.options.messageID}).then(function(t){t.success&&t.data.redirect_url?window.location=t.data.redirect_url:(console.error(t),s("#sv-wc-jilt-install-modal article").html(sv_wc_jilt_email_prompt.i18n.install_error),s("#sv-wc-jilt-install-button-install").hide())}).fail(function(){s("#sv-wc-jilt-install-modal article").html(sv_wc_jilt_email_prompt.i18n.install_error),s("#sv-wc-jilt-install-button-install").hide()}).always(function(){s("#sv-wc-jilt-install-modal .wc-backbone-modal-content").unblock()})}static onClose(t){return t.preventDefault(),this.options.onClose&&s(document).trigger(this.options.onClose),!0}},s.JiltPromotions.Messages=class{static enableMessage(t){s.JiltPromotions.Messages.handleMessage(t,"sv_wc_jilt_enable_message","sv_wc_jilt_prompt_install.nonces.enable_message")}static dismissMessage(t){s.JiltPromotions.Messages.handleMessage(t,"sv_wc_jilt_dismiss_message","sv_wc_jilt_prompt_install.nonces.dismiss_message")}static handleMessage(t,l,o){var i={action:l,nonce:o,message_id:t};s.post(ajaxurl,i,function(s){s.success||console.error(s)})}}});